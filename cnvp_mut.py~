#!/usr/bin/env python3

import pandas as pd
import matplotlib.pyplot as plt

cnvp_file = pd.read_csv('~/programs/python_files/seven_ten/igv_data/205549600031_R01C01.bins.igv',
                        sep="\t",header=0,names=['chrom', 'start', 'end', 'feature', 'metrics'])

variants_file = pd.read_csv('~/Documents/neuropathologie/fasta_bam_vcf_files/294234-DNA-FFPE_MPILEUP.vcf',
                            sep='\t',comment='#',names=['chrom','position','id','ref','alt','qual','filter',
                                                        'info','format','sample'])


# filter CNVP
cnv = cnvp_file[['chrom','start','end','metrics']]
cnv = cnv.replace(regex=r'[a-z]',value = '')
cnv = cnv.replace(regex=r'X',value = 23)
cnv = cnv.replace(regex=r'Y',value = 24)
cnv = cnv[(cnv['metrics'] < -0.2) | (cnv['metrics'] > 0.2)]
cnvChrom = cnv['chrom']
cnvStart = cnv['start']
cnvEnd = cnv['end']

# filter variants
vars = variants_file[['chrom','position']]
vars = vars.replace(regex=r'X',value = 23)
vars = vars.replace(regex=r'Y',value = 24)
varChrom = vars['chrom']
varPos = vars['position']
vars['varCombPos '] = varChrom.astype('str') + ':' + varPos.astype('str')

cnvPos = []
for index, row in cnv.iterrows():
    start = row['start']
    end = row['end']
    chrom = row['chrom']



#print(cnv.head())
#print(cnvChrom.unique())
#print(varChrom.unique())










# Plot CNVP or vars

#y_cnv = cnvp['metrics']
#x_cnv = cnvp['chrom']
#plt.scatter(x_cnv,y_cnv,s=0.4,alpha=0.7)

#y_var = vars['position']
#x_var = vars['chrom']

#plt.scatter(x_var,y_var,s=10,alpha=0.7)
#plt.show()








